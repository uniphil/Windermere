{% extends 'base-full.html' %}

{% set map_nav = [
  {'name': 'Slope', 'href': '#', 'selected': true, 'children': [
    {'name': 'Channels', 'href': '#', 'children': [
      {'name': 'Large Channels', 'href': '#'},
      {'name': 'Small Channels', 'href': '#'},
    ]},
    {'name': 'Levees and Splays', 'selected': true, 'href': '#'},
    {'name': 'Mass Transport Deposits', 'href': '#'},
  ]},
  {'name': 'Channel-Lobe Transition Zone', 'href': '#'},
  {'name': 'Basin Floor Lobes', 'href': '#', 'children': [
    {'name': 'Isolated Scour', 'href': '#'},
    {'name': 'Avulsion Splay', 'href': '#'},
    {'name': 'Feeder Channel', 'href': '#'},
    {'name': 'Distributary Channel', 'href': '#'},
    {'name': 'Terminal Splay', 'href': '#'}
  ]},
  {'name': 'Old Fort Point', 'href': '#'},
  {'name': 'Current Events', 'href': '#'},
] %}


{% block page_content %}
  <nav class="tree">
    <ul>
      {% for zone in map_nav %}
        <li{{ ' class="selected"'|safe if zone.selected }}>
          <a href="{{ zone.href }}">{{ zone.name }}</a>
          {% if zone.children %}
            <ul>
              {% for subzone in zone.children %}
                <li{{ ' class="selected"'|safe if subzone.selected }}>
                  <a href="{{ subzone.href }}">{{ subzone.name }}</a>
                  {% if subzone.children %}
                    <ul>
                      {% for subsub in subzone.children %}
                        <li{{ ' class="selected"'|safe if subsub.selected }}>
                          <a href="{{ subsub.href }}">{{ subsub.name }}</a>
                        </li>
                      {% endfor %}
                    </ul>
                  {% endif %}
                </li>
              {% endfor %}
            </ul>
          {% endif %}
        </li>
      {% endfor %}
    </ul>
  </nav>


  <div class="row">

    <div class="col-sm-3 col-lg-2">
      <h4>Filter</h4>
      <ul class="nav nav-pills nav-stacked">
          <li class="{% if not filtered %}active{% endif %}">
            <a href=".?">Everything</a>
          </li>
        {% for type, records, count in data %}
          <li class="{% if type.active %}active{% endif %}{% if not count and not type.active %}disabled{% endif %}">
            <a href=".?filter={{ type.name }}">{{ type.plural }}{% if count %} <small class="text-muted">{{ count }}</small>{% endif %}</a>
          </li>
        {% endfor %}
      </ul>
    </div>

    <div class="col-sm-9 col-lg-10">
      {% block page_main %}

        <h2>Mass Transport</h2>

        {% for type, records, count in data %}
          {% if records is not none and count > 0 %}
            <div class="type-summary">
              <h3>{{ type.name }}</h3>
              <ul class="type-summary-list list-unstyled">
                {% for rec in records %}
                  <li>
                    <p><a href="#" class="btn btn-default btn-xs ttbutton" data-icon="d" data-toggle="tooltip" title="Download"><span class="text-hide"> Download</span></a> <a href="#">{{ rec.title }}</a>{% if rec.label %} <span class="label label-warning">{{ rec.label }}</span>{% endif %}</p>
                  </li>
                {% endfor %}
              </ul>
              {% if not filtered and count > 3 %}
                <p>
                  <a href=".?filter={{ type.name }}" class="btn btn-sm btn-default summary-more">
                    View all {{ type.plural }} <span class="text-muted">({{ count }})</span>
                  </a>
                </p>
              {% endif %}
            </div>
          {% endif %}
        {% endfor %}

      {% endblock %}
    </div>

  </div>

{% endblock %}
